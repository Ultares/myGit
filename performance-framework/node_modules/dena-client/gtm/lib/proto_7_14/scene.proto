package msg.scene;

import "scenetype.proto";

//
// 命令字定义
//
enum MessageScene
{
	eMessageScene_EnterScene_S 			= 0x1100;	// 进入场景
	eMessageScene_Movement_CS 			= 0x1101;	// 移动消息
	eMessageScene_LeaveScene_C 			= 0x1102;	// 离开当前场景
	eMessageScene_UnitList_S 			= 0x1103;	// 场景中的单元列表(角色和NPC)
	eMessageScene_UnitEnter_S 			= 0x1104;	// 新角色进入场景
	eMessageScene_UnitLeave_S 			= 0x1105;	// 有角色离开场景
	eMessageScene_TalkNPC_C				= 0x1106;	// 与NPC对话
	eMessageScene_EnterCity_C			= 0x1107;	// 进入城镇
	eMessageScene_RandAction_CS 		= 0x1108;	// 同步随机动作
};

//
// 错误码定义
//
enum ErrorcodeScene
{
	eErrorcodeScene_Success 			= 0x000000;	// 成功

	eErrorcodeScene_InvalidScene 		= 0x110101;	// 玩家在非法的场景中移动
	eErrorcodeScene_NoRetreat			= 0x110200;	// 退无可退
};

//
// 协议定义
//

// 通知角色进入场景
message MessageEnterScene
{
	optional MessageScene 		id 		= 1 [default = eMessageScene_EnterScene_S];
	optional uint32 			sceneid = 2;		// 角色所在的场景ID
	optional int32 				pos_x 	= 3;		// 角色所在的X坐标
	optional int32 				pos_y 	= 4;		// 角色所在的Y坐标
	optional uint32 			resource= 5;		// 资源
};

// 角色在场景中移动
message MessageMoveInScene
{
	optional MessageScene 		id 		= 1 [default = eMessageScene_Movement_CS];
	optional uint64 			roleid 	= 2; 		// 角色ID
	optional int32 				movetype= 3;		// 移动类型
	optional int32 				direction=4;		// 方向
	optional int32 				pos_x 	= 5;		// X坐标
	optional int32 				pos_y 	= 6;		// Y坐标
};

// 角色离开场景
message MessageLeaveScene
{
	optional MessageScene 		id 		= 1 [ default = eMessageScene_LeaveScene_C ];
};

// 场景中的单元列表
message MessageUnitList
{
	optional MessageScene 		id 		= 1 [default = eMessageScene_UnitList_S];
	repeated SceneUnit 			list 	= 2; 		// 单元列表
};

// 新单元进入场景
message MessageUnitEnter
{
	optional MessageScene 		id 		= 1 [default = eMessageScene_UnitEnter_S];
	optional SceneUnit 			unit  	= 2;		// 新单元
};

// 有单元离开场景
message MessageUnitLeave
{
	optional MessageScene 		id 		= 1 [default = eMessageScene_UnitLeave_S];
	optional uint64 			roleid 	= 2;		// 角色ID
};

// 与NPC对话
message MessageTalkNPC
{
	optional MessageScene 		id 		= 1 [ default = eMessageScene_TalkNPC_C ];
	optional uint32 			npcid 	= 2;		// NPCID
};

// 同步随机动作
message MessageRandActionInScene
{
	optional MessageScene 		id 		= 1 [ default = eMessageScene_RandAction_CS ];
	required uint64 			roleid 	= 2;		// 角色ID
	required uint32 			avatar	= 3;		// 形象ID
	required uint32 			action 	= 4;		// 动作ID
};
